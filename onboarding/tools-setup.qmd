---
title: "Tools Setup"
subtitle: "Configure your development environment"
---

## Platform Recommendation

::: {.callout-important}
## Use Longleaf for Production Work

**Longleaf (UNC's HPC cluster)** is the recommended environment for:

- Running simulations and calibrations
- Reproducible analyses
- Collaborative work (shared file system)
- Long-running jobs

Local machines are fine for:

- Writing and editing code
- Small-scale testing
- Manuscript writing
:::

### Why Linux/HPC?

| Concern | Linux/HPC | Windows | macOS |
|---------|-----------|---------|-------|
| Reproducibility | Consistent environment | Path issues, line endings | Generally OK |
| Package compatibility | Full support | Some packages fail | Most work |
| Parallel computing | Native support | Limited | Good |
| Slurm/cluster | Native | N/A | N/A |
| Lab collaboration | Shared `/proj/rashidlab/` | N/A | N/A |

**Bottom line:** Develop locally if you prefer, but run production analyses on Longleaf.

## Development Paths

Choose your setup based on your workflow:

### Path A: Longleaf-Primary (Recommended)

Work directly on Longleaf via SSH or VS Code Remote:

1. [Set up Longleaf access](#longleaf-setup)
2. [Configure VS Code Remote SSH](#vs-code-remote-ssh)
3. Use module system for R, Quarto, etc.
4. No local R installation needed

### Path B: Local Development + Longleaf for Jobs

Develop locally, submit jobs to Longleaf:

1. [Set up local R environment](#local-r-setup)
2. [Set up Longleaf access](#longleaf-setup)
3. Push code via Git, run on cluster

### Path C: Local Only (Limited)

For small projects that don't need HPC:

1. [Set up local R environment](#local-r-setup)
2. Note: Some lab workflows won't work locally

---

## Longleaf Setup {#longleaf-setup}

### Request Access

1. Go to [ITS Research Computing](https://help.rc.unc.edu/request-a-cluster-account/)
2. Request Longleaf access with PI: Naim Rashid
3. Wait for approval email (~1-2 business days)

### Connect via SSH

```bash
# Basic SSH connection
ssh your_onyen@longleaf.unc.edu

# With X11 forwarding (for plots)
ssh -Y your_onyen@longleaf.unc.edu
```

**Windows users:** Use [MobaXterm](https://mobaxterm.mobatek.net/) or Windows Terminal with OpenSSH.

### SSH Key Setup (Passwordless Login)

```bash
# On your LOCAL machine, generate key
ssh-keygen -t ed25519 -C "your.email@unc.edu"

# Copy to Longleaf
ssh-copy-id your_onyen@longleaf.unc.edu

# Test (should not ask for password)
ssh your_onyen@longleaf.unc.edu
```

### Module System

Longleaf uses **modules** instead of package managers. Software is pre-installed and loaded on demand.

```bash
# See available modules
module avail

# Search for specific software
module avail r
module avail quarto

# Load R (check for latest version)
module load r/4.3.0

# Load multiple modules
module load r/4.3.0 gcc/11.2.0 quarto/1.4.550

# See loaded modules
module list

# Unload a module
module unload r

# Unload all
module purge
```

### Persistent Module Loading

Add to `~/.bashrc` on Longleaf:

```bash
# Load standard modules on login
module load r/4.3.0
module load gcc/11.2.0
module load git/2.36.0
```

Then: `source ~/.bashrc`

### Key Directories

| Path | Purpose | Quota |
|------|---------|-------|
| `/home/your_onyen/` | Home directory | 50 GB |
| `/work/users/y/o/your_onyen/` | Scratch space | 10 TB (not backed up) |
| `/proj/rashidlab/` | Lab shared space | Shared |
| `/proj/rashidlab/R-packages/` | Shared R packages | Shared |

### R Package Installation on Longleaf

```r
# First, set up personal library (one time)
dir.create("~/R/library", recursive = TRUE)

# Add to ~/.Rprofile
cat('.libPaths(c("~/R/library", "/proj/rashidlab/R-packages", .libPaths()))\n',
    file = "~/.Rprofile", append = TRUE)

# Restart R, then install packages
install.packages("data.table")
```

### Quarto on Longleaf

```bash
# Load Quarto module
module load quarto/1.4.550

# Verify
quarto --version

# Render document
quarto render manuscript.qmd --to pdf
```

**Note:** If Quarto module isn't available, check `module avail quarto` or contact ITS Research Computing.

---

## VS Code Remote SSH

The recommended way to work on Longleaf with a modern editor.

### Setup

1. Install [VS Code](https://code.visualstudio.com/)
2. Install the **Remote - SSH** extension
3. Press `Ctrl+Shift+P` → "Remote-SSH: Connect to Host"
4. Enter: `your_onyen@longleaf.unc.edu`
5. VS Code opens a remote session on Longleaf

### Recommended Extensions (install on remote)

- R Extension for Visual Studio Code
- Quarto
- GitLens

### SSH Config (Optional)

Create `~/.ssh/config` on your local machine:

```
Host longleaf
    HostName longleaf.unc.edu
    User your_onyen
    ForwardAgent yes
    ForwardX11 yes
```

Then connect with just: `ssh longleaf` or select "longleaf" in VS Code.

---

## Local R Setup {#local-r-setup}

For local development (Path B or C).

### Install R

| Platform | Method |
|----------|--------|
| **macOS** | Download from [CRAN](https://cran.r-project.org/) or `brew install r` |
| **Linux (Ubuntu/Debian)** | `sudo apt install r-base r-base-dev` |
| **Linux (Fedora)** | `sudo dnf install R` |
| **Windows** | Download from [CRAN](https://cran.r-project.org/) |

### Install RStudio (Optional)

Download from [posit.co](https://posit.co/download/rstudio-desktop/)

### Essential Packages

```r
# Core packages
install.packages(c(
  "data.table",
  "targets",
  "tarchetypes",
  "crew",
  "here",
  "yaml"
))

# For clinical trial work
install.packages(c(
  "survival",
  "DiceKriging",
  "lhs"
))

# For cluster computing (if using crew.cluster)
install.packages("crew.cluster")
```

### Windows-Specific Notes

::: {.callout-warning}
## Windows Limitations

Some packages and workflows have issues on Windows:

- **Path separators**: Use `here::here()` or forward slashes
- **Line endings**: Configure Git to handle (`git config --global core.autocrlf true`)
- **Some packages**: May fail to compile (use pre-built binaries when available)
- **Parallel computing**: `mclapply()` doesn't work; use `parLapply()` or `future`
- **Shell scripts**: Won't run natively; use Git Bash or WSL

**Recommendation:** For serious work, use Longleaf or install [WSL 2](https://docs.microsoft.com/en-us/windows/wsl/install) (Windows Subsystem for Linux).
:::

### macOS-Specific Notes

```bash
# Install Xcode command line tools (required for package compilation)
xcode-select --install

# If using Homebrew
brew install r
brew install --cask rstudio
```

---

## Git Setup

### Install Git

| Platform | Method |
|----------|--------|
| **Longleaf** | `module load git` (already available) |
| **macOS** | `xcode-select --install` or `brew install git` |
| **Linux** | `sudo apt install git` |
| **Windows** | [Git for Windows](https://gitforwindows.org/) (includes Git Bash) |

### Configure Git

```bash
git config --global user.name "Your Name"
git config --global user.email "your.email@unc.edu"

# Recommended settings
git config --global init.defaultBranch main
git config --global pull.rebase false
```

### GitHub CLI (Optional but Recommended)

| Platform | Method |
|----------|--------|
| **Longleaf** | May need to install manually or use web interface |
| **macOS** | `brew install gh` |
| **Linux** | See [GitHub CLI install](https://github.com/cli/cli/blob/trunk/docs/install_linux.md) |
| **Windows** | `winget install GitHub.cli` or download from [cli.github.com](https://cli.github.com/) |

```bash
# Authenticate
gh auth login
```

### SSH Keys for GitHub

```bash
# Generate key (if you don't have one)
ssh-keygen -t ed25519 -C "your.email@unc.edu"

# Start ssh-agent
eval "$(ssh-agent -s)"
ssh-add ~/.ssh/id_ed25519

# Copy public key
cat ~/.ssh/id_ed25519.pub
```

Then add to GitHub: Settings → SSH and GPG keys → New SSH key

---

## Quarto Setup

### On Longleaf

```bash
# Check available versions
module avail quarto

# Load
module load quarto/1.4.550

# Verify
quarto check
```

### Local Installation

Download from [quarto.org/docs/get-started](https://quarto.org/docs/get-started/)

| Platform | Method |
|----------|--------|
| **macOS** | Download installer or `brew install --cask quarto` |
| **Linux** | Download `.deb` or `.tar.gz` from website |
| **Windows** | Download installer from website |

### Verify Installation

```bash
quarto --version
quarto check
```

### LaTeX for PDF Output

Quarto can install TinyTeX automatically:

```bash
quarto install tinytex
```

Or on Longleaf, load the TeX module:

```bash
module load texlive
```

---

## Environment Summary

### Longleaf `.bashrc` Template

```bash
# ~/.bashrc on Longleaf

# Load standard modules
module load r/4.3.0
module load gcc/11.2.0
module load git/2.36.0
module load quarto/1.4.550

# R library path
export R_LIBS_USER=~/R/library

# Useful aliases
alias ll='ls -la'
alias squeue-me='squeue -u $USER'
```

### Local `.Rprofile` Template

```r
# ~/.Rprofile (local machine)

# Set CRAN mirror
options(repos = c(CRAN = "https://cloud.r-project.org"))

# Useful options
options(
  warnPartialMatchDollar = TRUE,
  warnPartialMatchArgs = TRUE
)
```

### Longleaf `.Rprofile` Template

```r
# ~/.Rprofile on Longleaf

# Library paths (personal + shared lab + system)
.libPaths(c(
  "~/R/library",
  "/proj/rashidlab/R-packages",
  .libPaths()
))

# CRAN mirror
options(repos = c(CRAN = "https://cloud.r-project.org"))
```

---

## Verification Checklist

After setup, verify everything works:

```bash
# On Longleaf
ssh your_onyen@longleaf.unc.edu
module load r/4.3.0
R --version
Rscript -e "library(data.table); print('OK')"
module load quarto
quarto --version
git --version
```

```bash
# Locally (if using local setup)
R --version
Rscript -e "library(targets); print('OK')"
quarto --version
git --version
gh --version
```

---

Next: [First Project →](first-project.qmd)
